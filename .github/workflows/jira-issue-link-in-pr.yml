name: Link Jira issue key in PR
on:
  pull_request:
    types: [opened]
jobs:
  link_jira_issue: # ì‘ì—… ì´ë¦„
    runs-on: ubuntu-latest
    steps:
      - name: Find Jira Issue
        uses: cybervoid/gajira-get-issue@v1.1
        id: find
        with:
          input-text: ${{ github.head_ref }}
      - name: Update PR body with Jira link
        uses: AsasInnab/pr-body-action@v1
        if: steps.find.outputs.issue != ''
        with:
          body: |
            ## ğŸ“Œ ê´€ë ¨ ì´ìŠˆ
            - Jira Ticket: [${{ steps.find.outputs.issue }}](https://depromeet05.atlassian.net/browse/${{ steps.find.outputs.issue }})

            ${{ github.event.pull_request.body }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      
      - name: Update PR body without Jira link
        uses: AsasInnab/pr-body-action@v1
        if: steps.find.outputs.issue == ''
        with:
          body: |
            ## ğŸ“Œ ê´€ë ¨ ì´ìŠˆ
            <!-- Jira ì´ìŠˆ ë²ˆí˜¸ê°€ ë¸Œëœì¹˜ ì´ë¦„ì—ì„œ ê°ì§€ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤ -->
            <!-- ìˆ˜ë™ìœ¼ë¡œ ì¶”ê°€í•´ì£¼ì„¸ìš”: - Jira Ticket: [NPP26-XXX](https://nota-dev.atlassian.net/browse/NPP02-XXX) -->
            ${{ github.event.pull_request.body }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
